

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>kse.kymera.kymera.generic.accmd &mdash; KSE 0.21.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../_static/css/qcom.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../../../_static/kse.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../../search.html"/>
    <link rel="top" title="KSE 0.21.0 documentation" href="../../../../../index.html"/>
        <link rel="up" title="Module code" href="../../../../index.html"/> 

  
  <script src="../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../index.html" class="icon icon-home"> KSE
          

          
          </a>

          
            
            
              <div class="version">
                0.21.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../kse.html">kse package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../index.html">KSE</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../../../../index.html">Module code</a> &raquo;</li>
      
    <li>kse.kymera.kymera.generic.accmd</li>
    <li class="wy-breadcrumbs-aside">
      
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for kse.kymera.kymera.generic.accmd</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright (c) 2017 Qualcomm Technologies International, Ltd.</span>
<span class="c1"># All rights reserved.</span>
<span class="c1"># Qualcomm Technologies International, Ltd. Confidential and Proprietary.</span>
<span class="c1">#</span>
<span class="sd">&quot;&quot;&quot;Audio Subsystem Command Interpreter Generic/Common library&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>

<span class="kn">from</span> <span class="nn">kats.framework.library.log</span> <span class="k">import</span> <span class="n">log_input</span><span class="p">,</span> <span class="n">log_output</span><span class="p">,</span> <span class="n">log_input_output</span><span class="p">,</span> <span class="n">log_exception</span>
<span class="kn">from</span> <span class="nn">kats.library.types.int_types</span> <span class="k">import</span> <span class="n">IntHexU16</span>

<span class="n">SYSTEM_BUS_HOST_SYS</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">ACCMD_CMD_ID_REQUEST_RESPONSE</span> <span class="o">=</span> <span class="mh">0x0000</span>
<span class="n">ACCMD_CMD_ID_RESPONSE</span> <span class="o">=</span> <span class="mh">0x2000</span>
<span class="n">ACCMD_CMD_ID_INDICATION</span> <span class="o">=</span> <span class="mh">0x4000</span>
<span class="n">ACCMD_CMD_ID_RESERVED</span> <span class="o">=</span> <span class="mh">0x8000</span>

<span class="n">ACCMD_CMD_ID_NO_CMD_REQ</span> <span class="o">=</span> <span class="mh">0x0000</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_REQ</span> <span class="o">=</span> <span class="mh">0x0001</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_REQ</span> <span class="o">=</span> <span class="mh">0x0002</span>
<span class="n">ACCMD_CMD_ID_STREAM_CLOSE_SOURCE_REQ</span> <span class="o">=</span> <span class="mh">0x0003</span>
<span class="n">ACCMD_CMD_ID_STREAM_CLOSE_SINK_REQ</span> <span class="o">=</span> <span class="mh">0x0004</span>
<span class="n">ACCMD_CMD_ID_STREAM_CONFIGURE_REQ</span> <span class="o">=</span> <span class="mh">0x0005</span>
<span class="n">ACCMD_CMD_ID_STREAM_SYNC_SID_REQ</span> <span class="o">=</span> <span class="mh">0x0006</span>
<span class="n">ACCMD_CMD_ID_STREAM_CONNECT_REQ</span> <span class="o">=</span> <span class="mh">0x0007</span>
<span class="n">ACCMD_CMD_ID_STREAM_TRANSFORM_DISCONNECT_REQ</span> <span class="o">=</span> <span class="mh">0x0008</span>
<span class="n">ACCMD_CMD_ID_GET_FIRMWARE_VERSION_REQ</span> <span class="o">=</span> <span class="mh">0x0009</span>
<span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_REQ</span> <span class="o">=</span> <span class="mh">0x000a</span>
<span class="n">ACCMD_CMD_ID_DESTROY_OPERATORS_REQ</span> <span class="o">=</span> <span class="mh">0x000b</span>
<span class="n">ACCMD_CMD_ID_OPERATOR_MESSAGE_REQ</span> <span class="o">=</span> <span class="mh">0x000c</span>
<span class="n">ACCMD_CMD_ID_START_OPERATORS_REQ</span> <span class="o">=</span> <span class="mh">0x000d</span>
<span class="n">ACCMD_CMD_ID_STOP_OPERATORS_REQ</span> <span class="o">=</span> <span class="mh">0x000e</span>
<span class="n">ACCMD_CMD_ID_RESET_OPERATORS_REQ</span> <span class="o">=</span> <span class="mh">0x000f</span>
<span class="n">ACCMD_CMD_ID_MESSAGE_FROM_OPERATOR_REQ</span> <span class="o">=</span> <span class="mh">0x0010</span>
<span class="n">ACCMD_CMD_ID_GET_FIRMWARE_ID_STRING_REQ</span> <span class="o">=</span> <span class="mh">0x0011</span>
<span class="n">ACCMD_CMD_ID_PRODTEST_REQ</span> <span class="o">=</span> <span class="mh">0x0012</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_INFO_REQ</span> <span class="o">=</span> <span class="mh">0x0013</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_CAPABILITIES_REQ</span> <span class="o">=</span> <span class="mh">0x0014</span>
<span class="n">ACCMD_CMD_ID_STREAM_EXTERNAL_DETACH_REQ</span> <span class="o">=</span> <span class="mh">0x0015</span>
<span class="n">ACCMD_CMD_ID_STREAM_SOURCE_DRAINED_REQ</span> <span class="o">=</span> <span class="mh">0x0016</span>
<span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_EX_REQ</span> <span class="o">=</span> <span class="mh">0x0017</span>
<span class="n">ACCMD_CMD_ID_GET_MEM_USAGE_REQ</span> <span class="o">=</span> <span class="mh">0x0018</span>
<span class="n">ACCMD_CMD_ID_CLEAR_MEM_WATERMARKS_REQ</span> <span class="o">=</span> <span class="mh">0x0019</span>
<span class="n">ACCMD_CMD_ID_GET_MIPS_USAGE_REQ</span> <span class="o">=</span> <span class="mh">0x001a</span>
<span class="c1"># old command ACCMD_CMD_ID_SET_SYSTEM_STREAM_RATE_REQ = 0x001b</span>
<span class="c1"># old command ACCMD_CMD_ID_GET_SYSTEM_STREAM_RATE_REQ = 0x001c</span>
<span class="n">ACCMD_CMD_ID_STREAM_DISCONNECT_REQ</span> <span class="o">=</span> <span class="mh">0x001d</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_FROM_SOURCE_REQ</span> <span class="o">=</span> <span class="mh">0x001e</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_FROM_SINK_REQ</span> <span class="o">=</span> <span class="mh">0x001f</span>
<span class="n">ACCMD_CMD_ID_CAP_DOWNLOAD_REMOVE_KCS_REQ</span> <span class="o">=</span> <span class="mh">0x0020</span>
<span class="n">ACCMD_CMD_ID_SET_SYSTEM_FRAMEWORK_REQ</span> <span class="o">=</span> <span class="mh">0x0021</span>
<span class="n">ACCMD_CMD_ID_GET_SYSTEM_FRAMEWORK_REQ</span> <span class="o">=</span> <span class="mh">0x0022</span>
<span class="n">ACCMD_CMD_ID_UNSOLICITED_SYSTEM_FRAMEWORK_REQ</span> <span class="o">=</span> <span class="mh">0x0023</span>
<span class="n">ACCMD_CMD_ID_MIC_BIAS_CONFIGURE_REQ</span> <span class="o">=</span> <span class="mh">0x0024</span>
<span class="n">ACCMD_CMD_ID_CODEC_SET_IIR_FILTER_REQ</span> <span class="o">=</span> <span class="mh">0x0025</span>
<span class="n">ACCMD_CMD_ID_CODEC_SET_IIR_FILTER_16BIT_REQ</span> <span class="o">=</span> <span class="mh">0x0026</span>
<span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_LOAD_REQ</span> <span class="o">=</span> <span class="mh">0x0027</span>
<span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_UNLOAD_REQ</span> <span class="o">=</span> <span class="mh">0x0028</span>
<span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_START_REQ</span> <span class="o">=</span> <span class="mh">0x0029</span>
<span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_STOP_REQ</span> <span class="o">=</span> <span class="mh">0x002a</span>
<span class="n">ACCMD_CMD_ID_STREAM_MCLK_ACTIVATE_REQ</span> <span class="o">=</span> <span class="mh">0x002b</span>
<span class="n">ACCMD_CMD_ID_SET_MCLK_SOURCE_TYPE_REQ</span> <span class="o">=</span> <span class="mh">0x002c</span>
<span class="n">ACCMD_CMD_ID_GET_OPERATORS_REQ</span> <span class="o">=</span> <span class="mh">0x002d</span>
<span class="n">ACCMD_CMD_ID_PS_SHUTDOWN_REQ</span> <span class="o">=</span> <span class="mh">0x002e</span>
<span class="n">ACCMD_CMD_ID_PS_READ_REQ</span> <span class="o">=</span> <span class="mh">0x002f</span>
<span class="n">ACCMD_CMD_ID_PS_WRITE_REQ</span> <span class="o">=</span> <span class="mh">0x0030</span>
<span class="n">ACCMD_CMD_ID_PS_DELETE_REQ</span> <span class="o">=</span> <span class="mh">0x0031</span>
<span class="n">ACCMD_CMD_ID_PS_SHUTDOWN_COMPLETE_REQ</span> <span class="o">=</span> <span class="mh">0x0032</span>
<span class="n">ACCMD_CMD_ID_PS_REGISTER_REQ</span> <span class="o">=</span> <span class="mh">0x0033</span>
<span class="n">ACCMD_CMD_ID_SET_PROFILER_REQ</span> <span class="o">=</span> <span class="mh">0x0034</span>
<span class="n">ACCMD_CMD_ID_CLOCK_CONFIGURE_REQ</span> <span class="o">=</span> <span class="mh">0x0035</span>
<span class="n">ACCMD_CMD_ID_SET_ANC_IIR_FILTER_REQ</span> <span class="o">=</span> <span class="mh">0x0036</span>
<span class="n">ACCMD_CMD_ID_SET_ANC_LPF_FILTER_REQ</span> <span class="o">=</span> <span class="mh">0x0037</span>
<span class="n">ACCMD_CMD_ID_STREAM_ANC_ENABLE_REQ</span> <span class="o">=</span> <span class="mh">0x0038</span>
<span class="n">ACCMD_CMD_ID_STREAM_SIDETONE_EN_REQ</span> <span class="o">=</span> <span class="mh">0x0039</span>
<span class="n">ACCMD_CMD_ID_DATA_FILE_ALLOCATE_REQ</span> <span class="o">=</span> <span class="mh">0x003a</span>
<span class="n">ACCMD_CMD_ID_DATA_FILE_DEALLOCATE_REQ</span> <span class="o">=</span> <span class="mh">0x003b</span>
<span class="n">ACCMD_CMD_ID_CLOCK_POWER_SAVE_MODE_REQ</span> <span class="o">=</span> <span class="mh">0x003c</span>
<span class="n">ACCMD_CMD_ID_CAP_DOWNLOAD_ADD_KCS_REQ</span> <span class="o">=</span> <span class="mh">0x003d</span>
<span class="n">ACCMD_CMD_ID_CAP_DOWNLOAD_COMPLETE_KCS_REQ</span> <span class="o">=</span> <span class="mh">0x003e</span>
<span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_DISABLE_REQ</span> <span class="o">=</span> <span class="mh">0x003f</span>
<span class="n">ACCMD_CMD_ID_TRANSFORM_FROM_STREAM_REQ</span> <span class="o">=</span> <span class="mh">0x0040</span>
<span class="n">ACCMD_CMD_ID_FILE_DETAILS_REQ</span> <span class="o">=</span> <span class="mh">0x0041</span>
<span class="n">ACCMD_CMD_ID_ACQUIRE_FLASH_LOCK_REQ</span> <span class="o">=</span> <span class="mh">0x0042</span>
<span class="n">ACCMD_CMD_ID_RELEASE_FLASH_LOCK_REQ</span> <span class="o">=</span> <span class="mh">0x0043</span>
<span class="n">ACCMD_CMD_ID_MAP_CPU_SPEED_REQ</span> <span class="o">=</span> <span class="mh">0x0044</span>

<span class="n">ACCMD_CMD_ID_NO_CMD_RESP</span> <span class="o">=</span> <span class="mh">0x4000</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_RESP</span> <span class="o">=</span> <span class="mh">0x4001</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_RESP</span> <span class="o">=</span> <span class="mh">0x4002</span>
<span class="n">ACCMD_CMD_ID_STANDARD_RESP</span> <span class="o">=</span> <span class="mh">0x4003</span>
<span class="n">ACCMD_CMD_ID_STREAM_CONNECT_RESP</span> <span class="o">=</span> <span class="mh">0x4004</span>
<span class="n">ACCMD_CMD_ID_GET_FIRMWARE_VERSION_RESP</span> <span class="o">=</span> <span class="mh">0x4005</span>
<span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_RESP</span> <span class="o">=</span> <span class="mh">0x4006</span>
<span class="n">ACCMD_CMD_ID_DESTROY_OPERATORS_RESP</span> <span class="o">=</span> <span class="mh">0x4007</span>
<span class="n">ACCMD_CMD_ID_OPERATOR_MESSAGE_RESP</span> <span class="o">=</span> <span class="mh">0x4008</span>
<span class="n">ACCMD_CMD_ID_START_OPERATORS_RESP</span> <span class="o">=</span> <span class="mh">0x4009</span>
<span class="n">ACCMD_CMD_ID_STOP_OPERATORS_RESP</span> <span class="o">=</span> <span class="mh">0x400a</span>
<span class="n">ACCMD_CMD_ID_RESET_OPERATORS_RESP</span> <span class="o">=</span> <span class="mh">0x400b</span>
<span class="n">ACCMD_CMD_ID_GET_FIRMWARE_ID_STRING_RESP</span> <span class="o">=</span> <span class="mh">0x400c</span>
<span class="n">ACCMD_CMD_ID_PRODTEST_RESP</span> <span class="o">=</span> <span class="mh">0x400d</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_INFO_RESP</span> <span class="o">=</span> <span class="mh">0x400e</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_CAPABILITIES_RESP</span> <span class="o">=</span> <span class="mh">0x400f</span>
<span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_EX_RESP</span> <span class="o">=</span> <span class="mh">0x4010</span>
<span class="n">ACCMD_CMD_ID_GET_MEM_USAGE_RESP</span> <span class="o">=</span> <span class="mh">0x4011</span>
<span class="n">ACCMD_CMD_ID_CLEAR_MEM_WATERMARKS_RESP</span> <span class="o">=</span> <span class="mh">0x4012</span>
<span class="n">ACCMD_CMD_ID_GET_MIPS_USAGE_RESP</span> <span class="o">=</span> <span class="mh">0x4013</span>
<span class="c1"># old command ACCMD_CMD_ID_SET_SYSTEM_STREAM_RATE_RESP = 0x4014</span>
<span class="c1"># old command ACCMD_CMD_ID_GET_SYSTEM_STREAM_RATE_RESP = 0x4015</span>
<span class="n">ACCMD_CMD_ID_STREAM_DISCONNECT_RESP</span> <span class="o">=</span> <span class="mh">0x4016</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_FROM_SOURCE_RESP</span> <span class="o">=</span> <span class="mh">0x4017</span>
<span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_FROM_SINK_RESP</span> <span class="o">=</span> <span class="mh">0x4018</span>
<span class="n">ACCMD_CMD_ID_SET_SYSTEM_FRAMEWORK_RESP</span> <span class="o">=</span> <span class="mh">0x4019</span>
<span class="n">ACCMD_CMD_ID_GET_SYSTEM_FRAMEWORK_RESP</span> <span class="o">=</span> <span class="mh">0x401a</span>
<span class="n">ACCMD_CMD_ID_GET_IPC_INTERFACE_TEST_RESP</span> <span class="o">=</span> <span class="mh">0x401b</span>
<span class="n">ACCMD_CMD_ID_GET_OPERATORS_RESP</span> <span class="o">=</span> <span class="mh">0x401c</span>
<span class="n">ACCMD_CMD_ID_PS_SHUTDOWN_RESP</span> <span class="o">=</span> <span class="mh">0x401d</span>  <span class="c1"># apparently not used</span>
<span class="n">ACCMD_CMD_ID_PS_READ_RESP</span> <span class="o">=</span> <span class="mh">0x401e</span>
<span class="n">ACCMD_CMD_ID_PS_WRITE_RESP</span> <span class="o">=</span> <span class="mh">0x401f</span>
<span class="n">ACCMD_CMD_ID_PS_DELETE_RESP</span> <span class="o">=</span> <span class="mh">0x4020</span>
<span class="n">ACCMD_CMD_ID_PS_SHUTDOWN_COMPLETE_RESP</span> <span class="o">=</span> <span class="mh">0x4021</span>
<span class="n">ACCMD_CMD_ID_TRANSFORM_FROM_STREAM_RESP</span> <span class="o">=</span> <span class="mh">0x4022</span>

<span class="n">ACCMD_CMD_ID_SET_PROFILER_RESP</span> <span class="o">=</span> <span class="mh">0x4034</span>
<span class="n">ACCMD_CMD_ID_CLOCK_CONFIGURE_RESP</span> <span class="o">=</span> <span class="mh">0x4035</span>

<span class="n">ACCMD_CMD_ID_DATA_FILE_ALLOCATE_RESP</span> <span class="o">=</span> <span class="mh">0x403a</span>

<span class="n">ACCMD_CMD_ID_CLOCK_POWER_SAVE_MODE_RESP</span> <span class="o">=</span> <span class="mh">0x403c</span>
<span class="n">ACCMD_CMD_ID_FILE_DETAILS_RESP</span> <span class="o">=</span> <span class="mh">0x403d</span>
<span class="n">ACCMD_CMD_ID_FLASH_LOCK_RESP</span> <span class="o">=</span> <span class="mh">0x403e</span>

<span class="n">ACCMD_RESP_STATUS_OK</span> <span class="o">=</span> <span class="mh">0x0000</span>
<span class="n">ACCMD_RESP_STATUS_NO_SUCH_CMDID</span> <span class="o">=</span> <span class="mh">0x0001</span>
<span class="n">ACCMD_RESP_STATUS_BAD_REQ</span> <span class="o">=</span> <span class="mh">0x0002</span>
<span class="n">ACCMD_RESP_STATUS_ACCMD_QUEUE_FULL</span> <span class="o">=</span> <span class="mh">0x0003</span>
<span class="n">ACCMD_RESP_STATUS_ACCMD_CMD_PENDING</span> <span class="o">=</span> <span class="mh">0x0004</span>
<span class="n">ACCMD_RESP_STATUS_CMD_FAILED</span> <span class="o">=</span> <span class="mh">0x0005</span>
<span class="n">ACCMD_RESP_STATUS_NO_SUCH_SUB_CMD</span> <span class="o">=</span> <span class="mh">0x0006</span>

<span class="n">ACCMD_RESP_STATUS_STR</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">ACCMD_RESP_STATUS_OK</span><span class="p">:</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span>
    <span class="n">ACCMD_RESP_STATUS_NO_SUCH_CMDID</span><span class="p">:</span> <span class="s1">&#39;no such command id&#39;</span><span class="p">,</span>
    <span class="n">ACCMD_RESP_STATUS_BAD_REQ</span><span class="p">:</span> <span class="s1">&#39;bad request&#39;</span><span class="p">,</span>
    <span class="n">ACCMD_RESP_STATUS_ACCMD_QUEUE_FULL</span><span class="p">:</span> <span class="s1">&#39;accmd queue full&#39;</span><span class="p">,</span>
    <span class="n">ACCMD_RESP_STATUS_ACCMD_CMD_PENDING</span><span class="p">:</span> <span class="s1">&#39;command pending&#39;</span><span class="p">,</span>
    <span class="n">ACCMD_RESP_STATUS_CMD_FAILED</span><span class="p">:</span> <span class="s1">&#39;command failed&#39;</span><span class="p">,</span>
    <span class="n">ACCMD_RESP_STATUS_NO_SUCH_SUB_CMD</span><span class="p">:</span> <span class="s1">&#39;no such subcommand&#39;</span>
<span class="p">}</span>

<span class="n">ENDPOINT_TYPE_DICT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pcm&#39;</span><span class="p">:</span> <span class="mh">0x0001</span><span class="p">,</span>
    <span class="s1">&#39;i2s&#39;</span><span class="p">:</span> <span class="mh">0x0002</span><span class="p">,</span>
    <span class="s1">&#39;codec&#39;</span><span class="p">:</span> <span class="mh">0x0003</span><span class="p">,</span>
    <span class="s1">&#39;fm&#39;</span><span class="p">:</span> <span class="mh">0x0004</span><span class="p">,</span>
    <span class="s1">&#39;spdif&#39;</span><span class="p">:</span> <span class="mh">0x0005</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic&#39;</span><span class="p">:</span> <span class="mh">0x0006</span><span class="p">,</span>
    <span class="s1">&#39;shunt&#39;</span><span class="p">:</span> <span class="mh">0x0007</span><span class="p">,</span>
    <span class="s1">&#39;sco&#39;</span><span class="p">:</span> <span class="mh">0x0009</span><span class="p">,</span>
    <span class="s1">&#39;iso&#39;</span><span class="p">:</span> <span class="mh">0x0013</span><span class="p">,</span>
    <span class="s1">&#39;operator&#39;</span><span class="p">:</span> <span class="mh">0x001e</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">STREAM_KEY_TYPE_DICT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pcm_sync_rate&#39;</span><span class="p">:</span> <span class="mh">0x0100</span><span class="p">,</span>
    <span class="s1">&#39;pcm_master_clock_rate&#39;</span><span class="p">:</span> <span class="mh">0x0101</span><span class="p">,</span>
    <span class="s1">&#39;pcm_master_mode&#39;</span><span class="p">:</span> <span class="mh">0x0102</span><span class="p">,</span>
    <span class="s1">&#39;pcm_slot_count&#39;</span><span class="p">:</span> <span class="mh">0x0103</span><span class="p">,</span>
    <span class="s1">&#39;pcm_manchester_mode&#39;</span><span class="p">:</span> <span class="mh">0x0104</span><span class="p">,</span>
    <span class="s1">&#39;pcm_short_sync_mode&#39;</span><span class="p">:</span> <span class="mh">0x0105</span><span class="p">,</span>
    <span class="s1">&#39;pcm_manchester_slave_mode&#39;</span><span class="p">:</span> <span class="mh">0x0106</span><span class="p">,</span>
    <span class="s1">&#39;pcm_sign_extend_mode&#39;</span><span class="p">:</span> <span class="mh">0x0107</span><span class="p">,</span>
    <span class="s1">&#39;pcm_lsb_first_mode&#39;</span><span class="p">:</span> <span class="mh">0x0108</span><span class="p">,</span>
    <span class="s1">&#39;pcm_tx_tristate_mode&#39;</span><span class="p">:</span> <span class="mh">0x0109</span><span class="p">,</span>
    <span class="s1">&#39;pcm_tx_tristate_rising_edge_mode&#39;</span><span class="p">:</span> <span class="mh">0x010a</span><span class="p">,</span>
    <span class="s1">&#39;pcm_sync_suppress_enable&#39;</span><span class="p">:</span> <span class="mh">0x010b</span><span class="p">,</span>
    <span class="s1">&#39;pcm_gci_mode&#39;</span><span class="p">:</span> <span class="mh">0x010c</span><span class="p">,</span>
    <span class="s1">&#39;pcm_mute_enable&#39;</span><span class="p">:</span> <span class="mh">0x010d</span><span class="p">,</span>
    <span class="s1">&#39;pcm_long_length_sync&#39;</span><span class="p">:</span> <span class="mh">0x010e</span><span class="p">,</span>
    <span class="s1">&#39;pcm_sample_rising_edge&#39;</span><span class="p">:</span> <span class="mh">0x010f</span><span class="p">,</span>
    <span class="s1">&#39;pcm_rx_rate_delay&#39;</span><span class="p">:</span> <span class="mh">0x0113</span><span class="p">,</span>
    <span class="s1">&#39;pcm_sample_format&#39;</span><span class="p">:</span> <span class="mh">0x0114</span><span class="p">,</span>
    <span class="s1">&#39;pcm_manchester_mode_rx_offset&#39;</span><span class="p">:</span> <span class="mh">0x0115</span><span class="p">,</span>
    <span class="s1">&#39;pcm_audio_gain&#39;</span><span class="p">:</span> <span class="mh">0x0116</span><span class="p">,</span>
    <span class="s1">&#39;pcm_master_clk_source&#39;</span><span class="p">:</span> <span class="mh">0x0118</span><span class="p">,</span>
    <span class="s1">&#39;pcm_master_mclk_mult&#39;</span><span class="p">:</span> <span class="mh">0x0119</span><span class="p">,</span>
    <span class="s1">&#39;pcm_24bits_in_32bit_slot&#39;</span><span class="p">:</span> <span class="mh">0x011a</span><span class="p">,</span>

    <span class="s1">&#39;i2s_sync_rate&#39;</span><span class="p">:</span> <span class="mh">0x0200</span><span class="p">,</span>
    <span class="s1">&#39;i2s_master_clock_rate&#39;</span><span class="p">:</span> <span class="mh">0x0201</span><span class="p">,</span>
    <span class="s1">&#39;i2s_master_mode&#39;</span><span class="p">:</span> <span class="mh">0x0202</span><span class="p">,</span>
    <span class="s1">&#39;i2s_justify_format&#39;</span><span class="p">:</span> <span class="mh">0x0203</span><span class="p">,</span>
    <span class="s1">&#39;i2s_left_justify_delay&#39;</span><span class="p">:</span> <span class="mh">0x0204</span><span class="p">,</span>
    <span class="s1">&#39;i2s_channel_polarity&#39;</span><span class="p">:</span> <span class="mh">0x0205</span><span class="p">,</span>
    <span class="s1">&#39;i2s_audio_attenuation_enable&#39;</span><span class="p">:</span> <span class="mh">0x0206</span><span class="p">,</span>
    <span class="s1">&#39;i2s_audio_attenuation&#39;</span><span class="p">:</span> <span class="mh">0x0207</span><span class="p">,</span>
    <span class="s1">&#39;i2s_justify_resolution&#39;</span><span class="p">:</span> <span class="mh">0x0208</span><span class="p">,</span>
    <span class="s1">&#39;i2s_crop_enable&#39;</span><span class="p">:</span> <span class="mh">0x0209</span><span class="p">,</span>
    <span class="s1">&#39;i2s_bits_per_sample&#39;</span><span class="p">:</span> <span class="mh">0x020a</span><span class="p">,</span>
    <span class="s1">&#39;i2s_tx_start_sample&#39;</span><span class="p">:</span> <span class="mh">0x020b</span><span class="p">,</span>
    <span class="s1">&#39;i2s_rx_start_sample&#39;</span><span class="p">:</span> <span class="mh">0x020c</span><span class="p">,</span>
    <span class="s1">&#39;i2s_master_clk_source&#39;</span><span class="p">:</span> <span class="mh">0x020d</span><span class="p">,</span>
    <span class="s1">&#39;i2s_master_mclk_mult&#39;</span><span class="p">:</span> <span class="mh">0x020e</span><span class="p">,</span>

    <span class="s1">&#39;codec_input_rate&#39;</span><span class="p">:</span> <span class="mh">0x0300</span><span class="p">,</span>
    <span class="s1">&#39;codec_output_rate&#39;</span><span class="p">:</span> <span class="mh">0x0301</span><span class="p">,</span>
    <span class="s1">&#39;codec_input_gain&#39;</span><span class="p">:</span> <span class="mh">0x0302</span><span class="p">,</span>
    <span class="s1">&#39;codec_output_gain&#39;</span><span class="p">:</span> <span class="mh">0x0303</span><span class="p">,</span>
    <span class="s1">&#39;codec_raw_input_gain&#39;</span><span class="p">:</span> <span class="mh">0x0304</span><span class="p">,</span>
    <span class="s1">&#39;codec_raw_output_gain&#39;</span><span class="p">:</span> <span class="mh">0x0305</span><span class="p">,</span>
    <span class="s1">&#39;codec_output_gain_boost_enable&#39;</span><span class="p">:</span> <span class="mh">0x0306</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_gain&#39;</span><span class="p">:</span> <span class="mh">0x0307</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_enable&#39;</span><span class="p">:</span> <span class="mh">0x0308</span><span class="p">,</span>
    <span class="s1">&#39;codec_mic_input_gain_enable&#39;</span><span class="p">:</span> <span class="mh">0x0309</span><span class="p">,</span>
    <span class="s1">&#39;codec_low_power_output_stage_enable&#39;</span><span class="p">:</span> <span class="mh">0x030a</span><span class="p">,</span>
    <span class="s1">&#39;codec_quality_mode&#39;</span><span class="p">:</span> <span class="mh">0x030b</span><span class="p">,</span>
    <span class="s1">&#39;codec_output_interp_filter_mode&#39;</span><span class="p">:</span> <span class="mh">0x030c</span><span class="p">,</span>
    <span class="s1">&#39;codec_output_power_mode&#39;</span><span class="p">:</span> <span class="mh">0x030d</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_source&#39;</span><span class="p">:</span> <span class="mh">0x030e</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_source_point&#39;</span><span class="p">:</span> <span class="mh">0x030f</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_injection_point&#39;</span><span class="p">:</span> <span class="mh">0x0310</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_source_mask&#39;</span><span class="p">:</span> <span class="mh">0x0311</span><span class="p">,</span>
    <span class="s1">&#39;codec_individual_sidetone_gain&#39;</span><span class="p">:</span> <span class="mh">0x0312</span><span class="p">,</span>
    <span class="s1">&#39;codec_individual_sidetone_enable&#39;</span><span class="p">:</span> <span class="mh">0x0313</span><span class="p">,</span>
    <span class="s1">&#39;codec_adc_data_source_point&#39;</span><span class="p">:</span> <span class="mh">0x0314</span><span class="p">,</span>
    <span class="s1">&#39;codec_adc_route&#39;</span><span class="p">:</span> <span class="mh">0x0315</span><span class="p">,</span>
    <span class="s1">&#39;codec_sidetone_invert&#39;</span><span class="p">:</span> <span class="mh">0x0316</span><span class="p">,</span>
    <span class="s1">&#39;codec_g722_filter_enable&#39;</span><span class="p">:</span> <span class="mh">0x0317</span><span class="p">,</span>
    <span class="s1">&#39;codec_g722_fir_enable&#39;</span><span class="p">:</span> <span class="mh">0x0318</span><span class="p">,</span>
    <span class="s1">&#39;codec_codec_input_termination&#39;</span><span class="p">:</span> <span class="mh">0x0319</span><span class="p">,</span>
    <span class="s1">&#39;codec_output_quality&#39;</span><span class="p">:</span> <span class="mh">0x031a</span><span class="p">,</span>
    <span class="s1">&#39;codec_aov_mode_on&#39;</span><span class="p">:</span> <span class="mh">0x031b</span><span class="p">,</span>
    <span class="s1">&#39;codec_aov_max_entries&#39;</span><span class="p">:</span> <span class="mh">0x031c</span><span class="p">,</span>

    <span class="s1">&#39;spdif_output_rate&#39;</span><span class="p">:</span> <span class="mh">0x500</span><span class="p">,</span>
    <span class="s1">&#39;spdif_chnl_sts_report_mode&#39;</span><span class="p">:</span> <span class="mh">0x501</span><span class="p">,</span>
    <span class="s1">&#39;spdif_output_chnl_sts_dup_en&#39;</span><span class="p">:</span> <span class="mh">0x502</span><span class="p">,</span>
    <span class="s1">&#39;spdif_output_chnl_sts_word&#39;</span><span class="p">:</span> <span class="mh">0x503</span><span class="p">,</span>
    <span class="s1">&#39;spdif_auto_rate_detect&#39;</span><span class="p">:</span> <span class="mh">0x504</span><span class="p">,</span>
    <span class="s1">&#39;spdif_output_clk_source&#39;</span><span class="p">:</span> <span class="mh">0x506</span><span class="p">,</span>

    <span class="s1">&#39;digital_mic_input_rate&#39;</span><span class="p">:</span> <span class="mh">0x0600</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_input_gain&#39;</span><span class="p">:</span> <span class="mh">0x0601</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_sidetone_gain&#39;</span><span class="p">:</span> <span class="mh">0x0602</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_sidetone_enable&#39;</span><span class="p">:</span> <span class="mh">0x0603</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_clock_rate&#39;</span><span class="p">:</span> <span class="mh">0x0604</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_sidetone_source_point&#39;</span><span class="p">:</span> <span class="mh">0x0605</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_individual_sidetone_gain&#39;</span><span class="p">:</span> <span class="mh">0x0606</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_data_source_point&#39;</span><span class="p">:</span> <span class="mh">0x0607</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_route&#39;</span><span class="p">:</span> <span class="mh">0x0608</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_g722_filter_enable&#39;</span><span class="p">:</span> <span class="mh">0x0609</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_g722_fir_enable&#39;</span><span class="p">:</span> <span class="mh">0x060a</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_amp_sel&#39;</span><span class="p">:</span> <span class="mh">0x060b</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_chan_swap&#39;</span><span class="p">:</span> <span class="mh">0x060c</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_aov_mode_on&#39;</span><span class="p">:</span> <span class="mh">0x060d</span><span class="p">,</span>
    <span class="s1">&#39;digital_mic_aov_max_entries&#39;</span><span class="p">:</span> <span class="mh">0x060e</span><span class="p">,</span>

    <span class="c1"># available to all interfaces</span>
    <span class="s1">&#39;audio_channel_mute_enable&#39;</span><span class="p">:</span> <span class="mh">0x0700</span><span class="p">,</span>
    <span class="s1">&#39;audio_sample_size&#39;</span><span class="p">:</span> <span class="mh">0x0701</span><span class="p">,</span>
    <span class="s1">&#39;audio_source_metadata_enable&#39;</span><span class="p">:</span> <span class="mh">0x0703</span><span class="p">,</span>
    <span class="s1">&#39;audio_sink_delay&#39;</span><span class="p">:</span> <span class="mh">0x0704</span><span class="p">,</span>
    <span class="s1">&#39;audio_sample_period_deviation&#39;</span><span class="p">:</span> <span class="mh">0x0705</span><span class="p">,</span>
    <span class="s1">&#39;audio_disable_endpoint_processing&#39;</span><span class="p">:</span> <span class="mh">0x0710</span><span class="p">,</span>  <span class="c1"># 0 disable all endpoint processing, 1 dc removal</span>
    <span class="s1">&#39;audio_sra_filter&#39;</span><span class="p">:</span> <span class="mh">0x0711</span><span class="p">,</span>

    <span class="s1">&#39;shunt_l2cap_atu&#39;</span><span class="p">:</span> <span class="mh">0x0800</span><span class="p">,</span>  <span class="c1"># sink</span>
    <span class="s1">&#39;shunt_autoflush_enable&#39;</span><span class="p">:</span> <span class="mh">0x0801</span><span class="p">,</span>  <span class="c1"># sink</span>
    <span class="s1">&#39;shunt_tokens_allocated&#39;</span><span class="p">:</span> <span class="mh">0x0802</span><span class="p">,</span>  <span class="c1"># sink</span>
    <span class="s1">&#39;shunt_max_pdu_length&#39;</span><span class="p">:</span> <span class="mh">0x0803</span><span class="p">,</span>  <span class="c1"># source</span>
    <span class="s1">&#39;shunt_notify_when_drained&#39;</span><span class="p">:</span> <span class="mh">0x0804</span><span class="p">,</span>  <span class="c1"># source</span>

    <span class="s2">&quot;rm_enable_sw_adjust&quot;</span><span class="p">:</span> <span class="mh">0x1200</span><span class="p">,</span>  <span class="c1"># Enable software rate adjustment on an endpoint.</span>
    <span class="c1"># Default is true (non-zero). Set to false (zero) to</span>
    <span class="c1"># force adjustment to occur on another endpoint.</span>
    <span class="s2">&quot;rm_enable_hw_adjust&quot;</span><span class="p">:</span> <span class="mh">0x1201</span><span class="p">,</span>  <span class="c1"># Enable hardware rate adjustment on an endpoint.</span>
    <span class="c1"># Default is true (non-zero). Set to false (zero) to</span>
    <span class="c1"># force software rate adjustment to be used, or</span>
    <span class="c1"># adjustment to occur on another endpoint.</span>
    <span class="s2">&quot;rm_enable_deferred_kick&quot;</span><span class="p">:</span> <span class="mh">0x1205</span><span class="p">,</span>
    <span class="c1"># Value is boolean. If true, endpoint types which implement this</span>
    <span class="c1"># perform most of their kick processing in a high priority</span>
    <span class="c1"># background interrupt instead of in the (foreground) interrupt</span>
    <span class="c1"># context.                                                        --&gt;</span>
    <span class="s2">&quot;rm_use_rate_adjust_operator&quot;</span><span class="p">:</span> <span class="mh">0x1208</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">STREAM_INFO_DICT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;audio_sample_rate&#39;</span><span class="p">:</span> <span class="mh">0x0000</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">CREATE_OPERATOR_EX_DICT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="mh">0x0001</span><span class="p">,</span>
    <span class="s1">&#39;processor_id&#39;</span><span class="p">:</span> <span class="mh">0x0002</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">FRAMEWORK_KEY_DICT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># acknowledgement of an imminent shutdown</span>
    <span class="s1">&#39;shutdown_prepare&#39;</span><span class="p">:</span> <span class="mh">0x0001</span><span class="p">,</span>
    <span class="c1"># getting the build ID integer.</span>
    <span class="s1">&#39;build_id&#39;</span><span class="p">:</span> <span class="mh">0x0002</span><span class="p">,</span>
    <span class="c1"># getting the build ID string.</span>
    <span class="s1">&#39;build_id_string&#39;</span><span class="p">:</span> <span class="mh">0x0003</span><span class="p">,</span>
    <span class="c1"># getting and setting the stream rate.</span>
    <span class="s1">&#39;stream_rate&#39;</span><span class="p">:</span> <span class="mh">0x0004</span><span class="p">,</span>
    <span class="c1"># When set to TRUE, the firmware calls panic() rather than fault(). See PanicOnFault MIB entry.</span>
    <span class="s1">&#39;panic_on_fault&#39;</span><span class="p">:</span> <span class="mh">0x0005</span><span class="p">,</span>
    <span class="c1"># Enables/Disables the built-in profiler.</span>
    <span class="s1">&#39;profiler_enable&#39;</span><span class="p">:</span> <span class="mh">0x0006</span><span class="p">,</span>
    <span class="c1"># Used for getting and setting system kick period. This should only be set on system startup.</span>
    <span class="c1"># Changing the kick period with a running processing graph may have unpredictable results</span>
    <span class="s1">&#39;kick_period&#39;</span><span class="p">:</span> <span class="mh">0x0007</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">CALLBACK</span> <span class="o">=</span> <span class="s1">&#39;callback&#39;</span>
<span class="n">FILTER</span> <span class="o">=</span> <span class="s1">&#39;flt&#39;</span>


<div class="viewcode-block" id="Accmd"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd">[docs]</a><span class="k">class</span> <span class="nc">Accmd</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Accmd generic protocol</span>

<span class="sd">    This class handles all accmd messages</span>

<span class="sd">    Args:</span>
<span class="sd">        uut (kats.core.uut_base.UutBase): Uut instance</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uut</span><span class="p">,</span> <span class="n">subsystem</span><span class="o">=</span><span class="n">SYSTEM_BUS_HOST_SYS</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_log&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_subsystem</span> <span class="o">=</span> <span class="n">subsystem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uut</span> <span class="o">=</span> <span class="n">uut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="n">subsystem</span><span class="p">]</span>  <span class="c1"># NOTE specific for hydra</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uut</span><span class="o">.</span><span class="n">message_register_handler</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_received</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_message_received</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">unsolicited_msgs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ACCMD_CMD_ID_MESSAGE_FROM_OPERATOR_REQ</span><span class="p">,</span>
                                <span class="n">ACCMD_CMD_ID_UNSOLICITED_SYSTEM_FRAMEWORK_REQ</span><span class="p">]</span>

            <span class="n">cmd_id</span><span class="p">,</span> <span class="n">seq_no</span><span class="p">,</span> <span class="n">_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmd_id</span> <span class="ow">in</span> <span class="n">unsolicited_msgs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STANDARD_RESP</span><span class="p">,</span> <span class="p">[</span><span class="n">ACCMD_RESP_STATUS_OK</span><span class="p">],</span> <span class="n">sequence_num</span><span class="o">=</span><span class="n">seq_no</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># pylint: disable=broad-except</span>
            <span class="k">pass</span>

        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">callback</span><span class="p">[</span><span class="n">FILTER</span><span class="p">]</span> <span class="ow">or</span> <span class="n">callback</span><span class="p">[</span><span class="n">FILTER</span><span class="p">](</span><span class="n">msg</span><span class="p">):</span>
                <span class="n">callback</span><span class="p">[</span><span class="n">CALLBACK</span><span class="p">]([</span><span class="n">IntHexU16</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_get_sequence_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span> <span class="o">&lt;</span> <span class="mi">255</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span>

    <span class="k">def</span> <span class="nf">_format_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequence_num</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;format ACCMD with id:</span><span class="si">%s</span><span class="s1"> and payload:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sequence_num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sequence_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sequence_num</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">payload_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmd_id</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sequence_num</span><span class="p">]</span> <span class="o">+</span> <span class="n">payload</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">IntHexU16</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">payload_list</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_value</span><span class="p">(</span><span class="n">dict_data</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_data</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_value</span><span class="p">(</span><span class="n">dict_data</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dict_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dict_data</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_status_descr</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ACCMD_RESP_STATUS_STR</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_standard_resp</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STANDARD_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>

<div class="viewcode-block" id="Accmd.receive"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.receive">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;response size:</span><span class="si">%s</span><span class="s1"> less than minimum&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="n">cmd_id</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">seq_no</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;header length:</span><span class="si">%s</span><span class="s1"> should be even&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">length</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">!=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;header length:</span><span class="si">%s</span><span class="s1"> and length:</span><span class="si">%s</span><span class="s1"> do not match&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">IntHexU16</span><span class="p">(</span><span class="n">cmd_id</span><span class="p">),</span> <span class="n">seq_no</span><span class="p">,</span> <span class="p">[</span><span class="n">IntHexU16</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span></div>

<div class="viewcode-block" id="Accmd.register_receive_callback"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.register_receive_callback">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">register_receive_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">flt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Register accmd messsage handler with optional filter</span>

<span class="sd">        Args:</span>
<span class="sd">            callback (func(list[int])): Message reception callback</span>
<span class="sd">            flt (func): Filtering function receiving one parameter being the message received and</span>
<span class="sd">                returning True if the message is accepted in the filter, False otherwise</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Message handler</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">CALLBACK</span><span class="p">:</span> <span class="n">callback</span><span class="p">,</span> <span class="n">FILTER</span><span class="p">:</span> <span class="n">flt</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.unregister_receive_callback"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.unregister_receive_callback">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">unregister_receive_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unregister previously register accmd messsage handler</span>

<span class="sd">        Args:</span>
<span class="sd">            handler (dict): Message handler</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.send"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.send">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmd_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">sequence_num</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send command message with optional payload</span>

<span class="sd">        Args:</span>
<span class="sd">            cmd_id (int): Command id</span>
<span class="sd">            payload (list[int]): Message parameters</span>
<span class="sd">            sequence_num (int): Sequence number or None for next</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_message</span><span class="p">(</span><span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="k">if</span> <span class="n">payload</span> <span class="k">else</span> <span class="p">[],</span>
                                       <span class="n">sequence_num</span><span class="o">=</span><span class="n">sequence_num</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uut</span><span class="o">.</span><span class="n">message_send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.send_recv"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.send_recv">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span>
                      <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cmd_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">send_recv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send command message with optional payload and receive response</span>

<span class="sd">        Args:</span>
<span class="sd">            cmd_id (int): Command id</span>
<span class="sd">            payload (list[int]): Message parameters</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[int, list[int]]: Response command (response) id, Response message</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_filter_by_sequence</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">seq</span> <span class="o">==</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;filtering out message seq:</span><span class="si">%s</span><span class="s1"> payload:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">seq</span> <span class="o">==</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_message</span><span class="p">(</span><span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="k">if</span> <span class="n">payload</span> <span class="k">else</span> <span class="p">[])</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uut</span><span class="o">.</span><span class="n">message_send_recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span>
                                              <span class="n">flt</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">_filter_by_sequence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">seq_no</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seq_no</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;response seq_no:0x</span><span class="si">%02x</span><span class="s1"> does not match command:0x</span><span class="si">%02x</span><span class="s1">&#39;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">seq_no</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;response empty response received&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ACCMD_RESP_STATUS_OK</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;response status:0x</span><span class="si">%02x</span><span class="s1"> invalid (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_status_descr</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="k">return</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span></div>

    <span class="c1"># ==============================================================================================</span>
    <span class="c1"># audio stream commands</span>
    <span class="c1"># ==============================================================================================</span>

<div class="viewcode-block" id="Accmd.no_cmd"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.no_cmd">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">no_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Standard ACCMD that sends no parameters and performs no actions.</span>
<span class="sd">        This command is provided to enable verification of the ACCMD service</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># note status is not coming in this response</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_message</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_NO_CMD_REQ</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uut</span><span class="o">.</span><span class="n">message_send_recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_header</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">seq_no</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seq_no</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;no_cmd_req seq_no:0x</span><span class="si">%02x</span><span class="s1"> does not match command:0x</span><span class="si">%02x</span><span class="s1">&#39;</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">seq_no</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_num</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;no_cmd_req empty response received&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_NO_CMD_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;no_cmd_req response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span></div>

<div class="viewcode-block" id="Accmd.stream_get_source"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_get_source">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
        <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;opt1&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;opt2&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_get_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint_type</span><span class="p">,</span> <span class="n">opt1</span><span class="p">,</span> <span class="n">opt2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain use of the specified resource</span>

<span class="sd">        If an attempt is made to reserve a resource that has already been successfully reserved</span>
<span class="sd">            - The request will succeed but return the source id supplied in response to the</span>
<span class="sd">              original request.</span>
<span class="sd">            - In the case of Operator; The command is used to obtain the source id for use in</span>
<span class="sd">              stream_connect_req.</span>

<span class="sd">        Attempting to reserve a resource may fail if:</span>
<span class="sd">            - The resource does not exist.</span>
<span class="sd">            - The resource cannot be reserved because another resource</span>
<span class="sd">              (that shares some aspect of its hardware), has already been reserved.</span>
<span class="sd">            - There are insufficient internal resources to support the requested resource</span>

<span class="sd">        Args:</span>
<span class="sd">            endpoint_type (str or int): Endpoint type, see (ENDPOINT_TYPE_DICT)</span>
<span class="sd">            opt1 (int): Optional parameter 1, its meaning depends on endpoint_type</span>
<span class="sd">            opt2 (int): Optional parameter 2, its meaning depends on endpoint_type</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: source endpoint id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">ENDPOINT_TYPE_DICT</span><span class="p">,</span> <span class="n">endpoint_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_source endpoint_type:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">endpoint_type</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt1</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_source opt1:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">opt1</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt2</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_source opt2:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">opt2</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">opt1</span><span class="p">,</span> <span class="n">opt2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_source response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_source response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.stream_get_sink"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_get_sink">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
        <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;opt1&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;opt2&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_get_sink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint_type</span><span class="p">,</span> <span class="n">opt1</span><span class="p">,</span> <span class="n">opt2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain use of the specified resource</span>

<span class="sd">        If an attempt is made to reserve a resource that has already been successfully reserved</span>
<span class="sd">            - The request will succeed but return the sink id supplied in response to the</span>
<span class="sd">              original request.</span>
<span class="sd">            - In the case of Operator; The command is used to obtain the sink id for use in</span>
<span class="sd">              stream_connect_req.</span>

<span class="sd">        Attempting to reserve a resource may fail if:</span>
<span class="sd">            - The resource does not exist.</span>
<span class="sd">            - The resource cannot be reserved because another resource</span>
<span class="sd">              (that shares some aspect of its hardware), has already been reserved.</span>
<span class="sd">            - There are insufficient internal resources to support the requested resource</span>

<span class="sd">        Args:</span>
<span class="sd">            endpoint_type (str or int): Endpoint type, see (ENDPOINT_TYPE_DICT)</span>
<span class="sd">            opt1 (int): Optional parameter 1, its meaning depends on endpoint_type</span>
<span class="sd">            opt2 (int): Optional parameter 2, its meaning depends on endpoint_type</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Source endpoint id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">ENDPOINT_TYPE_DICT</span><span class="p">,</span> <span class="n">endpoint_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink endpoint_type:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">endpoint_type</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt1</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink opt1:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">opt1</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt2</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink opt2:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">opt2</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">opt1</span><span class="p">,</span> <span class="n">opt2</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.stream_close_source"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_close_source">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_close_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Release the resource currently held by the specified source id</span>

<span class="sd">        Once released, the associated resource id becomes invalid and should be discarded.</span>
<span class="sd">        If the command is issued for a source id active in a transform, the transform is</span>
<span class="sd">        automatically disconnected, as part of the command.</span>

<span class="sd">        The command will fail if:</span>
<span class="sd">            - An unrecognised source id is specified, or</span>
<span class="sd">            - An attempt is made to close a source that cannot be closed in this way; such as an</span>
<span class="sd">              SCO source (Which is closed automatically when the SCO link is closed over Bluetooth</span>
<span class="sd">              HCI or by the remote peer.).</span>

<span class="sd">        Args:</span>
<span class="sd">            source_id (int): Source id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_CLOSE_SOURCE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">source_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_close_source&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.stream_close_sink"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_close_sink">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sink_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_close_sink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sink_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Release the resource currently held by the specified sink id</span>

<span class="sd">        Once released, the associated resource id becomes invalid and should be discarded.</span>
<span class="sd">        If the command is issued for a source id active in a transform, the transform is</span>
<span class="sd">        automatically disconnected, as part of the command.</span>

<span class="sd">        The command will fail if:</span>
<span class="sd">            - An unrecognised source id is specified, or</span>
<span class="sd">            - An attempt is made to close a source that cannot be closed in this way; such as an</span>
<span class="sd">              SCO source (Which is closed automatically when the SCO link is closed over Bluetooth</span>
<span class="sd">              HCI or by the remote peer.).</span>

<span class="sd">        Args:</span>
<span class="sd">            sink_id (int): Sink id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_CLOSE_SINK_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">sink_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_close_sink&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.stream_configure"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_configure">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sid&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure a single property of the specified source or sink id</span>

<span class="sd">        Any key value configured using stream_configure_req will persist for as long as the service</span>
<span class="sd">        instance exists.</span>

<span class="sd">        It is not neccessary to apply multiple key values for digital interfaces (PCM, I2s or SPDIF)</span>
<span class="sd">        Only apply Key values to a single source or sink id for each interface.</span>

<span class="sd">        Args:</span>
<span class="sd">            sid (int): source or sink id</span>
<span class="sd">            key (str or int): Property to be configured</span>
<span class="sd">            value (int): Value to be assigned to the key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">STREAM_KEY_TYPE_DICT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_configure key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_configure key:</span><span class="si">%s</span><span class="s1"> val:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_CONFIGURE_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="n">sid</span><span class="p">,</span>
                                          <span class="n">key_val</span><span class="p">,</span>
                                          <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">,</span>
                                          <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_configure&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.stream_sync_sid"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_sync_sid">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sid1&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;sid2&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_sync_sid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid1</span><span class="p">,</span> <span class="n">sid2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request that to specified endpoints to be synchronised, such as between the two channels</span>
<span class="sd">        of a stereo source. Synchronisation is used to prevent timing mis-match and drift between</span>
<span class="sd">        related sources or sinks.</span>

<span class="sd">        Sync group</span>
<span class="sd">        If two Endpoints are synchronised using stream_sync_sid_req they are considered to be in the</span>
<span class="sd">        same &quot;Sync Group&quot;.</span>
<span class="sd">        In this case, all source or sink ids within a particular Sync Group are enabled</span>
<span class="sd">        simultaneously (All stream_connect_req commands are deferred until the last has been</span>
<span class="sd">        issued.)</span>

<span class="sd">        A Sync Group containing more than two source or sink ids can be created using multiple</span>
<span class="sd">        stream_sync_sid ACCMDs.</span>
<span class="sd">        For example; the following sequence will create a Sync Group consisting of the four source</span>
<span class="sd">        or sink ids; a, b, c and d:</span>

<span class="sd">        - stream_sync_sid_req a b</span>
<span class="sd">        - stream_sync_sid_req c d</span>
<span class="sd">        - stream_sync_sid_req a c</span>

<span class="sd">        Source or sink ids closed using stream_close_source or stream_close_sink are automatically</span>
<span class="sd">        removed from any existing Sync Group.</span>

<span class="sd">        Args:</span>
<span class="sd">            sid1 (int): source or sink id</span>
<span class="sd">            sid2 (int): source or sink id, if 0 sid1 will be removed from any existing Sync Group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_SYNC_SID_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">sid1</span><span class="p">,</span> <span class="n">sid2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_sync_sid&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.stream_connect"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_connect">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
        <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;sink_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">,</span> <span class="n">sink_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect the specified source and sind id to create a transform</span>

<span class="sd">        Source and sink ids are obtained using:</span>
<span class="sd">        - stream_get_source command</span>
<span class="sd">        - stream_get_sink command</span>

<span class="sd">        Operator source and sink ids are derived from:</span>
<span class="sd">        - The Operator ID</span>
<span class="sd">        - The Connection Number on the Operator (Which starts from 0)</span>

<span class="sd">        Values for Source and Sink ID may be calculated using:</span>
<span class="sd">        - Source = op id + connection + 0x2000</span>
<span class="sd">        - Sink = op id + connection + 0xA000</span>

<span class="sd">        Args:</span>
<span class="sd">            source_id (int): Source id</span>
<span class="sd">            sink_id (int): Sink id</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Transform id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_CONNECT_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">source_id</span><span class="p">,</span> <span class="n">sink_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_CONNECT_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_connect response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_connect response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.stream_transform_disconnect"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_transform_disconnect">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;transform_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_transform_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disconnect an existing transform formed using stream_connect</span>

<span class="sd">        Args:</span>
<span class="sd">            transform_id (int): Transform id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_TRANSFORM_DISCONNECT_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="n">transform_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_transform_disconnect&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.get_firmware_version"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_firmware_version">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_firmware_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request firmware Build id from the audio sub-system</span>

<span class="sd">        Returns:</span>
<span class="sd">            (int) Firmware ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_GET_FIRMWARE_VERSION_REQ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_GET_FIRMWARE_VERSION_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_firmware_version response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_firmware_version length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.create_operator"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.create_operator">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cap_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">create_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cap_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an operator (an instance of a capability)</span>

<span class="sd">        Args:</span>
<span class="sd">            cap_id (int): Capability id</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Operator id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">cap_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;create_operator response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;create_operator response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.destroy_operators"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.destroy_operators">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;operators&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">destroy_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operators</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Destroy one or more existing operators and free any associated resources</span>

<span class="sd">        Args:</span>
<span class="sd">            operators (int): List of operator ids</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_DESTROY_OPERATORS_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)]</span> <span class="o">+</span> <span class="n">operators</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_DESTROY_OPERATORS_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;destroy_operators response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;destroy_operators length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Accmd.operator_message"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.operator_message">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;op_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;msg&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">operator_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op_id</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send an arbitrary message to a specific operator.</span>

<span class="sd">        The messages available and their meaning will depend upon the specific capability that</span>
<span class="sd">        the operator instantiates.</span>

<span class="sd">        Args:</span>
<span class="sd">            op_id (int): Operator id</span>
<span class="sd">            msg (list[int]): Message to be sent</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[int]: Message received in response from the operator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_OPERATOR_MESSAGE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">op_id</span><span class="p">]</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_OPERATOR_MESSAGE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;operator_message response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;operator_message response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">op_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;operator_message response op_id:</span><span class="si">%04x</span><span class="s1"> expecting:</span><span class="si">%04x</span><span class="s1">&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">op_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span></div>

<div class="viewcode-block" id="Accmd.start_operators"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.start_operators">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;operators&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">start_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operators</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts a set of operators processing data at the same time (or as close as it is</span>
<span class="sd">        possible)</span>

<span class="sd">        It is permitted to start an operator that has already been started.</span>
<span class="sd">        This command will have no effect and succeed.</span>

<span class="sd">        Attempting to start an operator that has nothing connected to it,</span>
<span class="sd">        or has insufficient connections, may fail (depending on the capability).</span>

<span class="sd">        Args:</span>
<span class="sd">            operators (list[int]): List of operator ids</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_START_OPERATORS_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)]</span> <span class="o">+</span> <span class="n">operators</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_START_OPERATORS_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;start_operators response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;start_operators length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Accmd.stop_operators"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stop_operators">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;operators&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stop_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operators</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops a set of operators at the same time (or as close as it is possible)</span>

<span class="sd">        It is permitted to stop an operator that has never been started or has already been stopped.</span>
<span class="sd">        No attempt is made to stop subsequent operators on the list</span>

<span class="sd">        Args:</span>
<span class="sd">            operators (list[int]): List of operator ids</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STOP_OPERATORS_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)]</span> <span class="o">+</span> <span class="n">operators</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STOP_OPERATORS_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stop_operators response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stop_operators length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Accmd.reset_operators"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.reset_operators">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;operators&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">reset_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operators</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset a set of operators at the same time (or as close as it is possible)</span>

<span class="sd">        The exact meaning of reset is capability-dependent, but will always leave the operator</span>
<span class="sd">        stopped.</span>

<span class="sd">        An operator may be reset whether it is running or stopped</span>

<span class="sd">        Args:</span>
<span class="sd">            operators (list[int]): List of operator ids</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_RESET_OPERATORS_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)]</span> <span class="o">+</span> <span class="n">operators</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_RESET_OPERATORS_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;reset_operators response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;reset_operators length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Accmd.get_firmware_id_string"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_firmware_id_string">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_firmware_id_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request firmware Build id string from the audio sub-system</span>

<span class="sd">        Returns:</span>
<span class="sd">            (str) Firmware ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_GET_FIRMWARE_ID_STRING_REQ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_GET_FIRMWARE_ID_STRING_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_firmware_id_string response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_firmware_id_string length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_firmware_id_string response length:</span><span class="si">%s</span><span class="s1"> does not match message&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">entry</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="c1"># ACCMD_CMD_ID_PRODTEST_REQ</span>

<div class="viewcode-block" id="Accmd.stream_get_info"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_get_info">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sid&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a single property of the specified source or sink id</span>

<span class="sd">        Args:</span>
<span class="sd">            sid (int): Source or sink id</span>
<span class="sd">            key (str): Property</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Property value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">STREAM_INFO_DICT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stream_get_info key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_GET_INFO_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">sid</span><span class="p">,</span> <span class="n">key_val</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_GET_INFO_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_info response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_info response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.get_capabilities"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_capabilities">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request a list of ids for the available capabilities</span>

<span class="sd">        The request will include any in-built capabilities, as well as all those currently available</span>
<span class="sd">        for download, whether or not any operator instances currently exist.</span>
<span class="sd">        At most 40 capabilities will be reported</span>

<span class="sd">        Args:</span>
<span class="sd">            start (int): Start index</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[int, list[int]]: Total number of available capabilities, capabilities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_GET_CAPABILITIES_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_GET_CAPABILITIES_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_capabilities response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_capabilities response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_capabilities response count:</span><span class="si">%d</span><span class="s1"> does not match data&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span></div>

<div class="viewcode-block" id="Accmd.stream_external_detach"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_external_detach">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_external_detach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Detach a shunt stream from its external source</span>

<span class="sd">        Once detached any further data received on the ACL handle and channel id are not forwarded</span>
<span class="sd">        on the shunt, however data already received remains accessinle.</span>
<span class="sd">        The shunt source must be explicitly closed using stream_close_source</span>

<span class="sd">        An l2cap (source) stream is automatically detached when the corresponding ACL link is</span>
<span class="sd">        detached or disconnected</span>

<span class="sd">        Args:</span>
<span class="sd">            source_id (int): Source id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_EXTERNAL_DETACH_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">source_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_external_detach&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.stream_source_drained"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_source_drained">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_source_drained</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Is sent by the shunt endpoint whem the shunt buffer is rained of all data (currently only</span>
<span class="sd">        supported for shunt source stream).</span>

<span class="sd">        This event is generated if the shunt source has been configured to notify when the shunt</span>
<span class="sd">        buffer is fully drained and either:</span>

<span class="sd">        - A stream_external_detach command is use on the stream, but there is no data waiting</span>
<span class="sd">            in the stream</span>
<span class="sd">        - The stream is already detached and all data has been drained from the stream</span>

<span class="sd">        Args:</span>
<span class="sd">            source_id (int): Shunt source id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_SOURCE_DRAINED_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">source_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_source_drained&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.create_operator_ex"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.create_operator_ex">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cap_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">create_operator_ex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cap_id</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an operator, parameterised version (an instance of a capability)</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            # Create operator from capability 1 with priority 1 in processor 0</span>
<span class="sd">            # All the following commands do the same thing</span>
<span class="sd">            create_operator_ex(1, [0x0001, 1], [0x0002, 0])</span>
<span class="sd">            create_operator_ex(1, [0x0001, 1], [&#39;processor_id&#39;, 0])</span>
<span class="sd">            create_operator_ex(1, [0x0001, 1], processor_id=0)</span>
<span class="sd">            create_operator_ex(1, [0x0002, 0], priority=1)</span>
<span class="sd">            create_operator_ex(1, priority=1, processor_id=0)</span>

<span class="sd">        Args:</span>
<span class="sd">            cap_id (int): Capability id</span>
<span class="sd">            args (list[list[int, int]]): List of key value pairs</span>
<span class="sd">            kwargs: Key value pairs</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Operator id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;arg </span><span class="si">%s</span><span class="s1"> invalid should be a list&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;arg </span><span class="si">%s</span><span class="s1"> invalid should be list of 2 elements&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;create_operator_ex key:</span><span class="si">%s</span><span class="s1"> val:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">key_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">CREATE_OPERATOR_EX_DICT</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;create_operator_ex key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;create_operator_ex key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">key_val</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">key_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">CREATE_OPERATOR_EX_DICT</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;create_operator_ex key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">entry</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;create_operator_ex key:</span><span class="si">%s</span><span class="s1"> val:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">entry</span><span class="p">]))</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">key_val</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">entry</span><span class="p">]])</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">params</span>
                                   <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">]]</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_EX_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">cap_id</span><span class="p">]</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_CREATE_OPERATOR_EX_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;create_operator_ex response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;create_operator_ex response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.get_mem_usage"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_mem_usage">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_mem_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processor_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request processor memory usage</span>

<span class="sd">        Args:</span>
<span class="sd">            processor_id (int): Processor, 0 is main</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict)</span>
<span class="sd">                heap_size (int) Heap size in words</span>
<span class="sd">                heap_current (int) Heap current in words</span>
<span class="sd">                heap_min (int) Heap min in words</span>
<span class="sd">                pool_size (int) Pool size in words</span>
<span class="sd">                pool_min (int) Pool current in words</span>
<span class="sd">                pool_current (int) Pool min in words</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_GET_MEM_USAGE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">processor_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_GET_MEM_USAGE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_mem_usage response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_mem_usage length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;heap_size&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;heap_current&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s1">&#39;heap_min&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;pool_size&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
            <span class="s1">&#39;pool_current&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
            <span class="s1">&#39;pool_min&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">payload</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="Accmd.clear_mem_watermarks"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.clear_mem_watermarks">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">clear_mem_watermarks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear memory watermarks&quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CLEAR_MEM_WATERMARKS_REQ</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_CLEAR_MEM_WATERMARKS_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;clear_mem_watermarks response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;clear_mem_watermarks length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Accmd.get_mips_usage"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_mips_usage">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;operators&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_mips_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operators</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request processor mips usage</span>

<span class="sd">        Args:</span>
<span class="sd">            operators (list[int]): List of operator ids</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[int, dict] Sleep in thousandths and dict with operator_id as key and operator mips</span>
<span class="sd">                in thousandths</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_GET_MIPS_USAGE_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)]</span> <span class="o">+</span> <span class="n">operators</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_GET_MIPS_USAGE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_mips_usage response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="c1"># NOTE this is the right check if len(payload) &lt; 2 or 2 * payload[1] != (len(payload) - 2):</span>
        <span class="c1"># however some old branches did not fix this so we make test less restrictive</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_mips_usage length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>

        <span class="n">ops</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ops</span><span class="p">):</span>
            <span class="n">ret</span><span class="p">[</span><span class="n">payload</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Accmd.stream_disconnect"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_disconnect">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                      <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;sink_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">,</span> <span class="n">sink_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disconnect a connection made between a specified source and sink</span>

<span class="sd">        Args:</span>
<span class="sd">            source_id (int): Source id</span>
<span class="sd">            sink_id (int): Sink id</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[int]: Transform id 1 and transform id 2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_DISCONNECT_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="n">source_id</span><span class="p">,</span> <span class="n">sink_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_DISCONNECT_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_disconnect response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_disconnect response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.stream_get_sink_from_source"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_get_sink_from_source">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_get_sink_from_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the sink paired with the specified source</span>

<span class="sd">        Args:</span>
<span class="sd">            source_id (int): Source id</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Sink id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_FROM_SOURCE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">source_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_GET_SINK_FROM_SOURCE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink_from_source response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_sink_from_source response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.stream_get_source_from_sink"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_get_source_from_sink">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sink_id&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_get_source_from_sink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sink_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the source paired with the specified sink</span>

<span class="sd">        Args:</span>
<span class="sd">            sink_id (int): Sink id</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Source id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_FROM_SINK_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">sink_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_STREAM_GET_SOURCE_FROM_SINK_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_source_from_sink response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;stream_get_source_from_sink response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.cap_download_remove_kcs"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.cap_download_remove_kcs">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">cap_download_remove_kcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kcs_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove downloadable capability bundle</span>

<span class="sd">        Args:</span>
<span class="sd">            kcs_id (int): Bundle id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CAP_DOWNLOAD_REMOVE_KCS_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">kcs_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;cap_download_remove_kcs&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.file_allocation_request"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.file_allocation_request">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">file_allocation_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">memory_type</span><span class="p">,</span> <span class="n">auto_remove</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Memory allocate request to file manager</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int): memory size to allocate (in bytes)</span>
<span class="sd">            memory_type (int): Type of memory to allocate</span>
<span class="sd">            auto_remove (int): 0 = don&#39;t auto_remove</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: File id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_DATA_FILE_ALLOCATE_REQ</span><span class="p">,</span>
                                        <span class="p">[</span><span class="n">memory_type</span><span class="p">,</span>
                                        <span class="n">auto_remove</span><span class="p">,</span>
                                        <span class="n">size</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">,</span>
                                        <span class="p">(</span><span class="n">size</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_DATA_FILE_ALLOCATE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;file_allocation_request response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;file_allocation_request response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> 
                                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.file_deallocation_request"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.file_deallocation_request">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">file_deallocation_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove allocated file</span>

<span class="sd">        Args:</span>
<span class="sd">            file_id (int): file id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_DATA_FILE_DEALLOCATE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">file_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;file_deallocation_request&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.set_system_framework"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.set_system_framework">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">set_system_framework</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set System Framework request</span>

<span class="sd">        Args:</span>
<span class="sd">            key (int): Key id</span>
<span class="sd">            message (list[int]): Message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">FRAMEWORK_KEY_DICT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;set_system_framework key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_SET_SYSTEM_FRAMEWORK_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">key_val</span><span class="p">]</span> <span class="o">+</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_SET_SYSTEM_FRAMEWORK_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;set_system_framework response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;set_system_framework_req length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Accmd.get_system_framework"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_system_framework">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_system_framework</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get System Framework request</span>

<span class="sd">        Args:</span>
<span class="sd">            key (int): Key id</span>
<span class="sd">            message (list[int]): Message</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[int]: Reply</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span> <span class="k">if</span> <span class="n">message</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">key_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">FRAMEWORK_KEY_DICT</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;get_system_framework key:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_GET_SYSTEM_FRAMEWORK_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">key_val</span><span class="p">]</span> <span class="o">+</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_GET_SYSTEM_FRAMEWORK_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_system_framework response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">payload</span></div>

    <span class="c1"># ACCMD_CMD_ID_MIC_BIAS_CONFIGURE_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_CODEC_SET_IIR_FILTER_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_CODEC_SET_IIR_FILTER_16BIT_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_AUX_PROCESSOR_LOAD_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_AUX_PROCESSOR_UNLOAD_REQ</span>

<div class="viewcode-block" id="Accmd.aux_processor_start"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.aux_processor_start">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">aux_processor_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start aux_processor</span>

<span class="sd">        Args:</span>
<span class="sd">            processor (int): Processor id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_START_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">processor</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;aux_processor_start&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.aux_processor_stop"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.aux_processor_stop">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">aux_processor_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop aux_processor</span>

<span class="sd">        Args:</span>
<span class="sd">            processor (int): Processor id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_AUX_PROCESSOR_STOP_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">processor</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;aux_processor_stop&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

    <span class="c1"># ACCMD_CMD_ID_STREAM_MCLK_ACTIVATE_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_SET_MCLK_SOURCE_TYPE_REQ</span>

<div class="viewcode-block" id="Accmd.get_operators"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.get_operators">[docs]</a>    <span class="nd">@log_input_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">get_operators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request a list of ids for the available operators</span>

<span class="sd">        The request will include all operators instantiated matching the filter.</span>
<span class="sd">        At most 20 operators will be reported</span>

<span class="sd">        Args:</span>
<span class="sd">            flt (int): cap_id information is requested for or 0 for all capabilities</span>
<span class="sd">            start (int): Start index</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[int, dict]: Total number of available operators for this filter, operators</span>
<span class="sd">                dict with key being the operator id and value the capability id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_GET_OPERATORS_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">flt</span><span class="p">,</span> <span class="n">start</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_GET_OPERATORS_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_operators response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_operators response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">if</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;get_operators response count:</span><span class="si">%d</span><span class="s1"> does not match data&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">op_ret</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)):</span>
            <span class="n">op_ret</span><span class="p">[</span><span class="n">payload</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ind</span><span class="p">]]</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">op_ret</span></div>

<div class="viewcode-block" id="Accmd.ps_shutdown"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.ps_shutdown">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">ps_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flush PS Keys to PS Store&quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_PS_SHUTDOWN_REQ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;ps_shutdown&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="Accmd.ps_register"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.ps_register">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">ps_register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Register PS Store&quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_PS_REGISTER_REQ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;ps_register&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

    <span class="c1"># ACCMD_CMD_ID_SET_PROFILER_REQ</span>

<div class="viewcode-block" id="Accmd.clock_configure"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.clock_configure">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">clock_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low_power_mode_clk</span><span class="p">,</span> <span class="n">custom_mode_clk</span><span class="p">,</span> <span class="n">active_mode_clk</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This command allow the APP to register its clock preference for the various operation</span>
<span class="sd">        modes.</span>

<span class="sd">        Args:</span>
<span class="sd">            low_power_mode_clk (int): Clock Configuration for Low Power Mode</span>
<span class="sd">            custom_mode_clk (int): Clock Configuration for Custom Mode</span>
<span class="sd">            active_mode_clk (int): Clock Configuration for Active Mode</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple</span>
<span class="sd">                int: Clock Configuration for Low Power Mode</span>
<span class="sd">                int: Clock Configuration for Custom Mode</span>
<span class="sd">                int: Clock Configuration for Active Mode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CLOCK_CONFIGURE_REQ</span><span class="p">,</span>
                                         <span class="p">[</span><span class="n">low_power_mode_clk</span><span class="p">,</span> <span class="n">custom_mode_clk</span><span class="p">,</span> <span class="n">active_mode_clk</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_CLOCK_CONFIGURE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;clock_configure response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;clock_configure response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>

    <span class="c1"># ACCMD_CMD_ID_SET_ANC_IIR_FILTER_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_SET_ANC_LPF_FILTER_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_STREAM_ANC_ENABLE_REQ</span>

<div class="viewcode-block" id="Accmd.stream_sidetone_enable"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.stream_sidetone_enable">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">stream_sidetone_enable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable stream uninterruptable sidetone</span>

<span class="sd">        Args:</span>
<span class="sd">            enable (int): Enable or disable the tone</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_STREAM_SIDETONE_EN_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">enable</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;stream_sidetone_enable&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

    <span class="c1"># ACCMD_CMD_ID_DATA_FILE_ALLOCATE_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_DATA_FILE_DEALLOCATE_REQ</span>

<div class="viewcode-block" id="Accmd.power_save_mode"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.power_save_mode">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">power_save_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This command allow the APP to register its Audio clock preference</span>

<span class="sd">        Args:</span>
<span class="sd">            mode (int): Power save operation Mode</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Power save operation Mode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CLOCK_POWER_SAVE_MODE_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">mode</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_CLOCK_POWER_SAVE_MODE_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;power_save_mode response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;power_save_mode response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Accmd.cap_download_add_kcs"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.cap_download_add_kcs">[docs]</a>    <span class="nd">@log_input</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">cap_download_add_kcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processor_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the transform currently connected to a source or sink</span>

<span class="sd">        Args:</span>
<span class="sd">            processor_id (int): Processor id</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Transform if exists, else 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_CAP_DOWNLOAD_ADD_KCS_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">processor_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;cap_download_add_kcs&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

    <span class="c1"># ACCMD_CMD_ID_CAP_DOWNLOAD_COMPLETE_KCS_REQ received message</span>
    <span class="c1"># ACCMD_CMD_ID_AUX_PROCESSOR_DISABLE_REQ</span>

<div class="viewcode-block" id="Accmd.transform_from_stream"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.transform_from_stream">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sid&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">transform_from_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the transform currently connected to a source or sink</span>

<span class="sd">        Args:</span>
<span class="sd">            sid (int): Source or sink id</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Transform if exists, else 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_TRANSFORM_FROM_STREAM_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">sid</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="o">!=</span> <span class="n">ACCMD_CMD_ID_TRANSFORM_FROM_STREAM_RESP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;transform_from_stream response cmd_id:</span><span class="si">%04x</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;transform_from_stream response length:</span><span class="si">%s</span><span class="s1"> invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="c1"># ACCMD_CMD_ID_FILE_DETAILS_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_ACQUIRE_FLASH_LOCK_REQ</span>
    <span class="c1"># ACCMD_CMD_ID_RELEASE_FLASH_LOCK_REQ</span>

<div class="viewcode-block" id="Accmd.map_cpu_speed"><a class="viewcode-back" href="../../../../../kse.kymera.kymera.generic.html#kse.kymera.kymera.generic.accmd.Accmd.map_cpu_speed">[docs]</a>    <span class="nd">@log_output</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">formatters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sid&#39;</span><span class="p">:</span> <span class="s1">&#39;0x</span><span class="si">%04x</span><span class="s1">&#39;</span><span class="p">})</span>
    <span class="nd">@log_exception</span>
    <span class="k">def</span> <span class="nf">map_cpu_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">frequency</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Map an abstract CPU speed to a concrete clock frequency.</span>
<span class="sd">        This commands is not available on all chips.</span>

<span class="sd">        Args:</span>
<span class="sd">            speed (int): Abstract CPU speed to change. Do not use NO_CHANGE here.</span>
<span class="sd">            frequency (int): Actual CPU clock frequency to be used.</span>
<span class="sd">                Usable frequency range and accuracy is dependent on the chip.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_recv</span><span class="p">(</span><span class="n">ACCMD_CMD_ID_MAP_CPU_SPEED_REQ</span><span class="p">,</span> <span class="p">[</span><span class="n">speed</span><span class="p">,</span> <span class="n">frequency</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_standard_resp</span><span class="p">(</span><span class="s1">&#39;map_cpu_speed&#39;</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 Qualcomm Technologies, Inc.

    </p>
  </div>
    <div class="sphinx-info">
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.qualcomm.com/python-users/sphinx_rtqd_theme">theme</a> provided by Qualcomm Python Users, derived from <a href="https://readthedocs.org">Read the Docs</a>.
    </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../',
            VERSION:'0.21.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>